<form (ngSubmit)="onSubmit()" #form="ngForm" *ngIf="showForm">
  <div class="form-group">
    <label>Client ID *</label>
    <select [(ngModel)]="config.clientId" name="clientId" required [disabled]="isEditMode"
            style="flex: 1;" (change)="onClientSelected()" #clientIdInput="ngModel">
      <option value="">-- Select a Client --</option>
      <option *ngFor="let client of clients" [value]="client.clientId">
        {{ client.clientId }} - {{ client.name }}
      </option>
    </select>
    <span class="validation-error" *ngIf="clientIdInput.invalid && clientIdInput.touched">
      <span *ngIf="clientIdInput.errors?.['required']">Client ID is required</span>
    </span>
  </div>
  
  <div class="form-group">
    <label>Time Window Requests *</label>
    <input type="number" [(ngModel)]="config.timeWindowRequests" name="timeWindowRequests" required min="1" #timeWindowRequestsInput="ngModel">
    <span class="validation-error" *ngIf="timeWindowRequestsInput.invalid && timeWindowRequestsInput.touched">
      <span *ngIf="timeWindowRequestsInput.errors?.['required']">Time Window Requests is required</span>
      <span *ngIf="timeWindowRequestsInput.errors?.['min']">Time Window Requests must be at least 1</span>
    </span>
  </div>
  
  <div class="form-group">
    <label>Time Window (seconds) *</label>
    <input type="number" [(ngModel)]="config.timeWindowSeconds" name="timeWindowSeconds" required min="1" #timeWindowSecondsInput="ngModel">
    <span class="validation-error" *ngIf="timeWindowSecondsInput.invalid && timeWindowSecondsInput.touched">
      <span *ngIf="timeWindowSecondsInput.errors?.['required']">Time Window (seconds) is required</span>
      <span *ngIf="timeWindowSecondsInput.errors?.['min']">Time Window (seconds) must be at least 1</span>
    </span>
  </div>
  
  <div class="form-group">
    <label>Monthly Requests *</label>
    <input type="number" [(ngModel)]="config.monthlyRequests" name="monthlyRequests" required min="1" #monthlyRequestsInput="ngModel">
    <span class="validation-error" *ngIf="monthlyRequestsInput.invalid && monthlyRequestsInput.touched">
      <span *ngIf="monthlyRequestsInput.errors?.['required']">Monthly Requests is required</span>
      <span *ngIf="monthlyRequestsInput.errors?.['min']">Monthly Requests must be at least 1</span>
    </span>
  </div>
  
  <div class="form-group">
    <label>Throttling Mode *</label>
    <select [(ngModel)]="config.throttlingMode" name="throttlingMode" required #throttlingModeInput="ngModel">
      <option value="">-- Select Throttling Mode --</option>
      <option value="HARD">Hard (Reject)</option>
      <option value="SOFT">Soft (Warning)</option>
    </select>
    <span class="validation-error" *ngIf="throttlingModeInput.invalid && throttlingModeInput.touched">
      <span *ngIf="throttlingModeInput.errors?.['required']">Throttling Mode is required</span>
    </span>
  </div>
  
  <div class="flex">
    <button type="submit" [disabled]="form.invalid">{{ isEditMode ? 'Update' : 'Create' }}</button>
    <button type="button" class="btn-secondary" (click)="cancelEdit()" *ngIf="isEditMode">Cancel</button>
  </div>
</form>

<div style="margin-bottom: 16px;">
  <button (click)="showNewForm()" *ngIf="!showForm">Add New Configuration</button>
</div>

<table *ngIf="configs.length > 0">
  <thead>
    <tr>
      <th>Client ID</th>
      <th>Time Window</th>
      <th>Monthly Limit</th>
      <th>Throttling</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let config of configs">
      <td>{{ config.clientId }}</td>
      <td>{{ config.timeWindowRequests }} / {{ config.timeWindowSeconds }}s</td>
      <td>{{ config.monthlyRequests }}</td>
      <td>{{ config.throttlingMode }}</td>
      <td>
        <div class="flex">
          <button (click)="editConfig(config)" class="btn-secondary" style="padding: 6px 12px;">Edit</button>
          <button (click)="deleteConfig(config.clientId)" class="btn-danger" style="padding: 6px 12px;">Delete</button>
        </div>
      </td>
    </tr>
  </tbody>
</table>

<p *ngIf="configs.length === 0" class="text-center" style="color: #999; padding: 20px;">
  No rate limit configurations found. Create one to get started.
</p>

